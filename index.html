<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Otec | Eletronicos, Acessórios e Fragrâncias de Luxo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
     <link rel="shortcut icon" href="ico.jpg" type="image/x-icon">
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Montserrat:wght@200;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #0070f3;
            --tech-cyan: #00dfd8;
            --deep-blue: #001e3c;
            --dark: #020617;
        }

        * {
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
        }

        body {
            background-color: var(--dark);
            color: #e2e8f0;
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            overflow-x: hidden;
        }

        .font-serif { font-family: 'Playfair Display', serif; }

        .text-tech {
            background: linear-gradient(135deg, #00dfd8 0%, #0070f3 50%, #00dfd8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(0, 112, 243, 0.3);
        }

        .bg-tech-gradient {
            background: linear-gradient(135deg, #0070f3 0%, #00dfd8 100%);
        }

        .input-luxury {
            background: rgba(0, 112, 243, 0.05);
            border: 1px solid rgba(0, 223, 216, 0.2);
            color: white;
            padding: 1rem;
            border-radius: 0.75rem;
            width: 100%;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .input-luxury:focus {
            outline: none;
            border-color: var(--tech-cyan);
            box-shadow: 0 0 15px rgba(0, 223, 216, 0.2);
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-glass {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(0, 112, 243, 0.3);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .btn-main {
            background: transparent;
            border: 1px solid var(--neon-blue);
            color: white;
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }

        .btn-main:hover {
            background: rgba(0, 112, 243, 0.1);
            box-shadow: 0 0 20px rgba(0, 112, 243, 0.4);
            border-color: var(--tech-cyan);
        }

        .btn-main:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        #toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: none;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .social-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid rgba(0, 112, 243, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            transition: all 0.3s ease;
        }

        .social-icon:hover {
            border-color: var(--tech-cyan);
            color: var(--tech-cyan);
            background: rgba(0, 223, 216, 0.05);
            transform: translateY(-3px);
            box-shadow: 0 0 15px rgba(0, 223, 216, 0.3);
        }

        /* Custom scrollbar for tech feel */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: var(--dark);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--deep-blue);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--neon-blue);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div id="toast"></div>

    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-slate-950/80 backdrop-blur-xl border-b border-blue-500/20 px-4 md:px-12 py-4 flex justify-between items-center">
        <div class="text-lg md:text-2xl font-bold tracking-[0.3em] text-tech uppercase cursor-pointer" onclick="location.reload()">Otec</div>
        <div class="flex items-center gap-3 md:gap-6">
            <button onclick="toggleAdminPanel()" class="text-[8px] md:text-[10px] uppercase tracking-widest text-blue-400/50 hover:text-cyan-400 transition">SISTEMA ADM</button>
            <div class="relative cursor-pointer p-2" onclick="openCart()">
                <i data-lucide="shopping-cart" class="h-5 w-5 md:h-6 md:w-6 text-blue-400"></i>
                <span id="cart-count" class="absolute top-0 right-0 bg-tech-gradient text-white text-[9px] font-bold px-1.5 rounded-full min-w-[16px] h-[16px] flex items-center justify-center shadow-[0_0_10px_rgba(0,112,243,0.5)]">0</span>
            </div>
        </div>
    </header>

    <main class="flex-grow flex flex-col">
        
        <!-- QUIZ SECTIONS -->
        <section id="quiz-section" class="flex-grow flex flex-col items-center justify-center px-4 py-16 text-center">
            <div id="quiz-intro" class="fade-in max-w-2xl">
                <span class="text-[9px] uppercase tracking-[0.4em] text-cyan-400 mb-4 block font-semibold">Análise de Perfil Digital</span>
                <h1 class="text-4xl md:text-7xl mb-6 font-serif italic text-tech leading-tight">Nós ajude a saber o que você quer</h1>
                <p class="text-slate-400 text-sm md:text-lg font-light mb-10">Algoritmo exclusivo para encontrar a fragrância, Acessórios e Eletronico que define o seu futuro.</p>
                <button onclick="startQuiz()" class="btn-main px-10 py-4 rounded-full text-xs uppercase tracking-[0.2em] font-semibold">Iniciar Algoritmo</button>
            </div>

            <div id="quiz-container" class="hidden w-full max-w-lg card-glass p-6 md:p-10 rounded-2xl fade-in">
                <div class="flex items-center justify-between mb-8 text-[9px] uppercase tracking-widest text-blue-300">
                    <span id="question-count">Módulo 1 de 4</span>
                </div>
                <h2 id="question-text" class="text-xl md:text-2xl mb-8 font-serif text-white italic"></h2>
                <div id="options-grid" class="grid grid-cols-1 gap-3"></div>
            </div>
        </section>

        <!-- LEAD SECTION -->
        <section id="lead-section" class="hidden flex-grow flex items-center justify-center px-4 py-10">
            <div class="w-full max-w-md card-glass p-8 rounded-3xl text-center fade-in">
                <h2 class="text-2xl mb-2 text-tech font-serif italic">Acesso Restrito</h2>
                <p class="text-blue-400/50 text-[10px] uppercase mb-8 tracking-widest">Identifique-se para desbloquear o catálogo</p>
                <form onsubmit="handleLead(event)" class="space-y-6 text-left">
                    <div class="space-y-1">
                        <label class="text-[9px] uppercase tracking-widest text-cyan-400 ml-1">Usuário</label>
                        <input type="text" id="lead-name" required class="input-luxury" placeholder="Seu Nome Completo">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[9px] uppercase tracking-widest text-cyan-400 ml-1">WhatsApp de Contato</label>
                        <input type="tel" id="lead-phone" required class="input-luxury" placeholder="Ex: 929842189">
                    </div>
                    <button type="submit" class="w-full btn-main py-4 rounded-xl text-xs uppercase tracking-[0.3em] font-bold mt-4 shadow-lg shadow-blue-500/10">Validar e Aceder</button>
                </form>
            </div>
        </section>

        <!-- CATALOG -->
        <section id="catalog-section" class="hidden px-4 md:px-12 py-12">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-6xl text-tech font-serif italic mb-2">Catálogo especial</h2>
                    <p class="text-[10px] uppercase tracking-[0.3em] text-blue-400">para <span id="user-name-display" class="text-white border-b border-cyan-400"></span></p>
                </div>
                <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
                <div id="catalog-loader" class="flex justify-center py-20 hidden">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-cyan-400"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="bg-slate-950 border-t border-blue-500/10 py-12 px-6">
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-10 text-center md:text-left">
            <div>
                <div class="text-xl font-bold tracking-[0.3em] text-tech uppercase mb-4">otec_oficial</div>
                <p class="text-[10px] text-slate-500 leading-relaxed uppercase tracking-widest">Inovação em uma loja de variedades de elite. A tecnologia aplicada ao luxo sensorial.</p>
            </div>
            <div class="text-[11px] text-slate-400 space-y-3">
                <p class="uppercase tracking-widest text-cyan-400 mb-2 font-bold">Formas de Contato</p>
                <div class="flex items-center justify-center md:justify-start gap-2">
                    <i data-lucide="map-pin" class="w-3 h-3 text-blue-500"></i>
                    <span>Luanda, Angola</span>
                </div>
                <div class="flex items-center justify-center md:justify-start gap-2">
                    <i data-lucide="phone" class="w-3 h-3 text-blue-500"></i>
                    <span>+244 959 481 506</span>
                </div>
                <div class="flex items-center justify-center md:justify-start gap-2">
                    <i data-lucide="mail" class="w-3 h-3 text-blue-500"></i>
                    <span>colifinance99@gmail.com</span>
                </div>
            </div>
            <div class="flex flex-col justify-between items-center md:items-end">
                <div class="flex gap-4 mb-6">
                    <a href="https://www.instagram.com/otec_oficial/" target="_blank" class="social-icon" title="Instagram">
                        <i data-lucide="instagram" class="w-5 h-5"></i>
                    </a>
                    <a href="https://www.facebook.com/profile.php?id=61583880916162&ref=PROFILE_EDIT_xav_ig_profile_page_web" target="_blank" class="social-icon" title="Facebook">
                        <i data-lucide="facebook" class="w-5 h-5"></i>
                    </a>
                    <a href="https://wa.me/244959481506" target="_blank" class="social-icon" title="WhatsApp">
                        <i data-lucide="message-circle" class="w-5 h-5"></i>
                    </a>
                </div>
                <div class="text-[9px] text-slate-700 uppercase tracking-[0.4em]">
                    © 2026 OTEC TECH-LUXURY • ANGOLA
                </div>
            </div>
        </div>
    </footer>

    <!-- MODALS -->
    <div id="admin-modal" class="hidden fixed inset-0 z-[70] flex items-center justify-center p-4 bg-slate-950/90">
        <div class="bg-slate-900 w-full max-w-2xl rounded-2xl border border-blue-500/30 overflow-hidden flex flex-col max-h-[90vh] shadow-[0_0_50px_rgba(0,112,243,0.2)]">
            <div class="p-5 bg-black flex justify-between items-center border-b border-cyan-400/30">
                <span class="text-[10px] uppercase tracking-[0.3em] text-cyan-400">Terminal de Gestão</span>
                <button onclick="toggleAdminPanel()" class="text-white text-2xl hover:text-cyan-400 transition">&times;</button>
            </div>
            
            <div id="admin-login" class="p-10 text-center">
                <input type="password" id="admin-pass" class="input-luxury text-center mb-6" placeholder="Token de Acesso">
                <button onclick="verifyAdmin()" class="w-full btn-main py-3 rounded-lg text-[10px] uppercase tracking-widest font-bold">Sincronizar</button>
            </div>

            <div id="admin-dashboard" class="hidden p-6 overflow-y-auto">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <h4 class="text-[10px] uppercase tracking-widest text-blue-300 mb-4">Input de Dados</h4>
                        <input type="text" id="p-name" placeholder="Designação do Item" class="input-luxury">
                        <input type="text" id="p-price" placeholder="Valor Unitário (Kz)" class="input-luxury">
                        <textarea id="p-desc" placeholder="Especificações" class="input-luxury h-20"></textarea>
                        <input type="file" id="p-img-file" accept="image/*" class="text-[10px] text-slate-500 cursor-pointer">
                        <button id="btn-publish" onclick="createProduct()" class="w-full btn-main py-4 rounded-xl text-[10px] uppercase tracking-widest font-bold">Upload para Nuvem</button>
                    </div>
                    <div>
                        <h4 class="text-[10px] uppercase tracking-widest text-blue-300 mb-4">Base de Dados Local</h4>
                        <div id="admin-products-list" class="space-y-2"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="cart-modal" class="hidden fixed inset-0 z-[60] flex justify-end bg-slate-950/80">
        <div class="bg-slate-950 w-full max-w-sm h-full shadow-2xl flex flex-col border-l border-blue-500/20">
            <div class="p-6 bg-slate-900 flex justify-between items-center border-b border-blue-500/10">
                <h3 class="text-lg font-serif text-tech italic">Cesta de Dados</h3>
                <button onclick="closeCart()" class="text-white text-3xl font-light hover:text-cyan-400">&times;</button>
            </div>
            <div id="cart-items" class="flex-grow overflow-y-auto p-6 space-y-4"></div>
            <div class="p-6 border-t border-blue-500/10 bg-slate-900 space-y-4">
                <div class="flex justify-between items-center px-2">
                    <span class="text-[10px] uppercase tracking-widest text-slate-400">Total Calculado</span>
                    <span id="cart-total" class="text-sm font-bold text-cyan-400">0 Kz</span>
                </div>
                <button onclick="checkout()" class="w-full btn-main py-4 rounded-xl uppercase tracking-widest text-[10px] font-bold">Processar Envio (WhatsApp)</button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        const SUPABASE_URL = 'https://zfhuomzkmwquqnrfzspj.supabase.co'; 
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmaHVvbXprbXdxdXFucmZ6c3BqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEwMTg1NjQsImV4cCI6MjA4NjU5NDU2NH0.786i5uhC4TbafTa3ZPAv6UCBu47b_pnhE_rAejXrJAs';

        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        let products = [];
        let cart = [];
        let userData = { name: '', phone: '' };
        let currentQIdx = 0;

        function showToast(msg, error = false) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.display = 'block';
            t.style.backgroundColor = error ? 'rgba(127, 29, 29, 0.8)' : 'rgba(0, 112, 243, 0.8)';
            t.style.color = 'white';
            t.style.borderColor = error ? '#ef4444' : '#06b6d4';
            setTimeout(() => t.style.display = 'none', 4000);
        }

        function parsePrice(priceStr) {
            if (!priceStr) return 0;
            const clean = priceStr.replace(/[^\d]/g, '');
            return parseInt(clean) || 0;
        }

        function formatPrice(num) {
            return num.toLocaleString('pt-AO') + " Kz";
        }

        const quizQuestions = [
            { t: "Qual é o seu Género", o: ["Masculino", "Femenino", "Outro"] },
            { t: "Qual produto vocẽ procura?", o: ["Fragrâcia", "Acessório", "Eletrónico"] },
            { t: "Você é ligado a Técnologia?", o: ["sim", "não", "mais ou menos"] },
            { t: "Onde vocẽ vai usar o seu produto?", o: ["Trabalho", "Casa", "Coetidiano"] }
        ];

        function startQuiz() {
            document.getElementById('quiz-intro').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            renderQuestion();
        }

        function renderQuestion() {
            const q = quizQuestions[currentQIdx];
            document.getElementById('question-count').innerText = `Módulo ${currentQIdx + 1} de 4`;
            document.getElementById('question-text').innerText = q.t;
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            q.o.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-xl border border-blue-500/10 bg-blue-500/5 text-[11px] uppercase tracking-wider text-slate-300 hover:border-cyan-400 hover:bg-cyan-400/5 transition-all duration-300";
                btn.innerText = opt;
                btn.onclick = () => {
                    if(currentQIdx < quizQuestions.length - 1) { currentQIdx++; renderQuestion(); }
                    else { showLead(); }
                };
                grid.appendChild(btn);
            });
        }

        function showLead() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('lead-section').classList.remove('hidden');
        }

        async function handleLead(e) {
            e.preventDefault();
            userData.name = document.getElementById('lead-name').value;
            userData.phone = document.getElementById('lead-phone').value;
            document.getElementById('lead-section').classList.add('hidden');
            document.getElementById('catalog-section').classList.remove('hidden');
            document.getElementById('user-name-display').innerText = userData.name;
            fetchProducts();
        }

        async function fetchProducts() {
            document.getElementById('catalog-loader').classList.remove('hidden');
            const { data, error } = await _supabase.from('produtos').select('*').order('created_at', { ascending: false });
            document.getElementById('catalog-loader').classList.add('hidden');
            if (error) {
                showToast("Erro na sincronização", true);
            } else {
                products = data || [];
                renderCatalog();
                if(!document.getElementById('admin-dashboard').classList.contains('hidden')) renderAdminList();
            }
        }

        function renderCatalog() {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = '';
            products.forEach((p, idx) => {
                grid.innerHTML += `
                    <div class="card-glass rounded-2xl overflow-hidden fade-in group">
                        <div class="relative overflow-hidden">
                           <img src="${p.imagem_url}" class="w-full aspect-[4/5] object-cover transition-transform duration-700 group-hover:scale-105">
                           <div class="absolute inset-0 bg-gradient-to-t from-slate-950 to-transparent opacity-60"></div>
                        </div>
                        <div class="p-5 relative">
                            <h3 class="text-xs font-serif text-tech italic mb-1 uppercase tracking-widest">${p.nome}</h3>
                            <div class="flex items-center justify-between mt-4">
                                <span class="text-xs font-bold text-cyan-400">${p.preco}</span>
                                <button onclick="addToCart(${idx})" class="text-[8px] border border-blue-500/50 px-4 py-1.5 rounded-full uppercase tracking-widest hover:bg-blue-500 hover:text-white transition-all shadow-sm">Adicionar</button>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function addToCart(idx) { cart.push(products[idx]); updateCart(); showToast("Item catalogado"); }
        
        function updateCart() {
            document.getElementById('cart-count').innerText = cart.length;
            const container = document.getElementById('cart-items');
            container.innerHTML = '';
            let total = 0;
            cart.forEach((item, i) => {
                total += parsePrice(item.preco);
                container.innerHTML += `
                    <div class="flex items-center gap-4 bg-blue-500/5 p-3 rounded-xl border border-blue-500/10">
                        <img src="${item.imagem_url}" class="w-12 h-12 object-cover rounded-lg border border-cyan-400/20">
                        <div class="flex-grow">
                            <p class="text-[10px] text-white uppercase font-semibold">${item.nome}</p>
                            <p class="text-[9px] text-cyan-400/70 mt-1">${item.preco}</p>
                        </div>
                        <button onclick="cart.splice(${i}, 1); updateCart();" class="text-slate-500 hover:text-red-400 p-2 transition">
                             <i data-lucide="trash-2" class="h-4 w-4"></i>
                        </button>
                    </div>`;
                lucide.createIcons();
            });
            document.getElementById('cart-total').innerText = formatPrice(total);
        }

        function openCart() { document.getElementById('cart-modal').classList.remove('hidden'); }
        function closeCart() { document.getElementById('cart-modal').classList.add('hidden'); }

        function checkout() {
            if (cart.length === 0) return showToast("A cesta de dados está vazia", true);
            let total = 0;
            let msg = `*REQUISIÇÃO FRECOLI TECH-LUXURY*%0A%0A`;
            msg += `*ID Usuário:* ${userData.name}%0A`;
            msg += `*Terminal:* ${userData.phone}%0A%0A`;
            msg += `*LISTA DE SELEÇÃO:*%0A`;
            cart.forEach(i => {
                msg += `• ${i.nome} - ${i.preco}%0A`;
                total += parsePrice(i.preco);
            });
            msg += `%0A*VALOR TOTAL:* ${formatPrice(total)}%0A%0A`;
            msg += `_Processando solicitação... Aguardo confirmação._`;
            window.open(`https://wa.me/244959481506?text=${msg}`);
        }

        function toggleAdminPanel() { document.getElementById('admin-modal').classList.toggle('hidden'); }
        
        function verifyAdmin() {
            const pass = document.getElementById('admin-pass').value;
            if(pass === "FRECOLI2024") {
                document.getElementById('admin-login').classList.add('hidden');
                document.getElementById('admin-dashboard').classList.remove('hidden');
                fetchProducts();
            } else {
                showToast("Token Inválido", true);
            }
        }

        async function createProduct() {
            const btn = document.getElementById('btn-publish');
            const name = document.getElementById('p-name').value;
            const price = document.getElementById('p-price').value;
            const file = document.getElementById('p-img-file').files[0];

            if(!name || !price || !file) return showToast("Parâmetros ausentes", true);

            btn.disabled = true;
            btn.innerText = "Sincronizando...";

            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = async () => {
                const { error } = await _supabase.from('produtos').insert([{ nome: name, preco: price, imagem_url: reader.result }]);
                if (error) {
                    showToast("Erro de rede: " + error.message, true);
                    btn.disabled = false;
                    btn.innerText = "Upload para Nuvem";
                } else {
                    showToast("Upload Concluído!");
                    location.reload();
                }
            };
        }

        function renderAdminList() {
            const list = document.getElementById('admin-products-list');
            list.innerHTML = '';
            products.forEach(p => {
                list.innerHTML += `
                    <div class="p-3 bg-black flex justify-between items-center rounded-lg border border-blue-500/10 text-[9px] uppercase">
                        <span class="text-blue-100 truncate max-w-[150px]">${p.nome}</span>
                        <button onclick="deleteProd(${p.id}, this)" class="text-red-400 hover:text-red-200 transition-colors px-2 py-1">Descartar</button>
                    </div>`;
            });
        }

        async function deleteProd(id, btn) {
            if(!confirm("Confirmar deleção permanente do registro?")) return;
            
            const originalText = btn.innerText;
            btn.innerText = "...";
            btn.disabled = true;

            try {
                const { error } = await _supabase
                    .from('produtos')
                    .delete()
                    .match({ id: id });

                if (error) {
                    showToast(`Falha: ${error.message}`, true);
                    btn.innerText = originalText;
                    btn.disabled = false;
                } else {
                    showToast("Registro apagado!");
                    products = products.filter(p => p.id !== id);
                    renderCatalog();
                    renderAdminList();
                }
            } catch (err) {
                showToast("Erro de Link", true);
                btn.innerText = originalText;
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>